<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="book_lnreqloancoll_2" language="groovy" pageWidth="798" pageHeight="798" orientation="Landscape" columnWidth="798" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="12f204a6-55c9-45e7-b353-ba2c17fad1e2">
	<property name="ireport.zoom" value="1.0514816984441804"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="679"/>
	<parameter name="as_coopid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_loanrequest_docno" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
lnreqloan.member_no,
FT_GETMBNAME('018001',lnreqloan.member_no) as getname,
lncontcoll.ref_collno,
lncontcoll.description,
mbmembmaster.card_person,
mbmembmaster.position_desc,
ftcm_calagemth(mbmembmaster.birth_date,lnreqloan.approve_date) as age,
mbmembmaster.birth_date,
lnreqloan.approve_date,
MBUCFMEMBGROUP.membgroup_code,
MBUCFMEMBGROUP.membgroup_desc,
mbmembmaster.salary_amount,
mbmembmaster.addr_no,
mbmembmaster.addr_moo,
mbmembmaster.addr_soi,
mbmembmaster.addr_village,
mbmembmaster.addr_road,
MBUCFTAMBOL.tambol_desc,
MBUCFDISTRICT.district_desc,
MBUCFPROVINCE.province_desc,
mbmembmaster.addr_postcode,
mbmembmaster.addr_phone,
mbmembmaster.addr_mobilephone,
mbmembmaster.addr_email,
lnreqloan.loanrequest_amt,
ftreadtbaht(lnreqloan.loanrequest_amt),
lnreqloan.period_payamt,
lnreqloan.period_payment,
lnreqloan.member_no,
lnreqloan.loancontract_no,
lnreqloan.loanrequest_docno,
lnreqloan.loanrequest_date,
lnucfloanobjective.loanobjective_desc ,
am.district_desc as group_am ,
lncontmaster.loanapprove_date,
FTCNVTDATE(lnreqloan.loanrequest_date,3) as apdate,
lncontmaster.loanapprove_amt
from
lnreqloan
left outer join lncontcoll on trim(lncontcoll.loancontract_no) = trim(lnreqloan.loancontract_no)
left outer join lncontmaster on trim(lncontmaster.loancontract_no) = trim(lnreqloan.loancontract_no)
left outer join mbmembmaster  on  lncontcoll.ref_collno = mbmembmaster.member_no
left outer join MBUCFMEMBGROUP on mbmembmaster.membgroup_code =MBUCFMEMBGROUP.membgroup_code
left outer join MBUCFDISTRICT am on MBUCFMEMBGROUP.addr_amphur = am.district_code
left outer join MBUCFPROVINCE on mbmembmaster.province_code =MBUCFPROVINCE.province_code
left outer join MBUCFDISTRICT on mbmembmaster.amphur_code = MBUCFDISTRICT.district_code and MBUCFDISTRICT.province_code =MBUCFPROVINCE.province_code
left outer join MBUCFTAMBOL on mbmembmaster.tambol_code =MBUCFTAMBOL.tambol_code and  MBUCFDISTRICT.district_code =MBUCFTAMBOL.district_code

left outer join lnucfloanobjective on trim(lnucfloanobjective.loanobjective_code) = trim(lnreqloan.loanobjective_code) and lncontmaster.loantype_code = lnucfloanobjective.loantype_code

where lncontcoll.coop_id = $P{as_coopid} and lncontcoll.ref_collno is not null
and lnreqloan.loanrequest_docno in ($P!{as_loanrequest_docno} )
order by lnreqloan.loancontract_no,lnreqloan.member_no ASC]]>
	</queryString>
	<field name="MEMBER_NO" class="java.lang.String"/>
	<field name="GETNAME" class="java.lang.String"/>
	<field name="REF_COLLNO" class="java.lang.String"/>
	<field name="DESCRIPTION" class="java.lang.String"/>
	<field name="CARD_PERSON" class="java.lang.String"/>
	<field name="POSITION_DESC" class="java.lang.String"/>
	<field name="AGE" class="java.lang.String"/>
	<field name="BIRTH_DATE" class="java.sql.Timestamp"/>
	<field name="APPROVE_DATE" class="java.sql.Timestamp"/>
	<field name="MEMBGROUP_CODE" class="java.lang.String"/>
	<field name="MEMBGROUP_DESC" class="java.lang.String"/>
	<field name="SALARY_AMOUNT" class="java.math.BigDecimal"/>
	<field name="ADDR_NO" class="java.lang.String"/>
	<field name="ADDR_MOO" class="java.lang.String"/>
	<field name="ADDR_SOI" class="java.lang.String"/>
	<field name="ADDR_VILLAGE" class="java.lang.String"/>
	<field name="ADDR_ROAD" class="java.lang.String"/>
	<field name="TAMBOL_DESC" class="java.lang.String"/>
	<field name="DISTRICT_DESC" class="java.lang.String"/>
	<field name="PROVINCE_DESC" class="java.lang.String"/>
	<field name="ADDR_POSTCODE" class="java.lang.String"/>
	<field name="ADDR_PHONE" class="java.lang.String"/>
	<field name="ADDR_MOBILEPHONE" class="java.lang.String"/>
	<field name="ADDR_EMAIL" class="java.lang.String"/>
	<field name="LOANREQUEST_AMT" class="java.math.BigDecimal"/>
	<field name="FTREADTBAHT(LNREQLOAN.LOANREQUEST_AMT)" class="java.lang.String"/>
	<field name="PERIOD_PAYAMT" class="java.math.BigDecimal"/>
	<field name="PERIOD_PAYMENT" class="java.math.BigDecimal"/>
	<field name="LOANCONTRACT_NO" class="java.lang.String"/>
	<field name="LOANREQUEST_DOCNO" class="java.lang.String"/>
	<field name="LOANREQUEST_DATE" class="java.sql.Timestamp"/>
	<field name="LOANOBJECTIVE_DESC" class="java.lang.String"/>
	<field name="GROUP_AM" class="java.lang.String"/>
	<field name="LOANAPPROVE_DATE" class="java.sql.Timestamp"/>
	<field name="APDATE" class="java.lang.String"/>
	<field name="LOANAPPROVE_AMT" class="java.math.BigDecimal"/>
	<group name="refcollno" isStartNewPage="true">
		<groupExpression><![CDATA[$F{REF_COLLNO}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<detail>
		<band height="798">
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="404" y="79" width="95" height="17" uuid="52154162-7100-4e44-a54e-829b36af3965"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANREQUEST_AMT}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="220" y="101" width="294" height="17" uuid="49b538b0-4dd5-4802-8852-5583ce7a7997"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GETNAME}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="68" y="211" width="177" height="17" uuid="dc98bb43-71d2-497d-932f-8c873cf4c7ad"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCRIPTION}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="241" y="235" width="83" height="17" uuid="8c60777d-183b-43b9-b0e9-a8ae22b44911"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{REF_COLLNO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="33" y="255" width="178" height="17" uuid="06e4c613-39b5-48fa-ac19-0f2f4488d3b6"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{MEMBGROUP_DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="239" y="79" width="106" height="17" uuid="aa0185be-82ca-4c7b-a697-c50ecbbc6e15"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANCONTRACT_NO}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="283" y="211" width="100" height="17" uuid="c4101016-48dc-474f-bb54-b0c8add68900"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($F{BIRTH_DATE})]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="399" y="211" width="44" height="17" uuid="b3dc7b29-0904-4851-a930-9ccd80f2a110"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AGE}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="544" y="211" width="157" height="17" uuid="803974b5-fa04-4348-9824-8a3684b99a95"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{CARD_PERSON}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="233" y="278" width="140" height="17" uuid="767f1612-9259-469f-a808-2f532fb5e0cf"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{TAMBOL_DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="532" y="255" width="70" height="17" uuid="4f2484b2-bff2-4cd5-8c2f-2c78eac5e6f2"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ADDR_NO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="632" y="255" width="69" height="17" uuid="77993b41-6621-4c23-901d-bb03a134815d"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ADDR_MOO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="500" y="235" width="201" height="17" uuid="72155d97-589f-4111-892e-29838b9059e7"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{POSITION_DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="33" y="278" width="167" height="17" uuid="21c0cbe5-c185-44a0-bfe4-7b854219496a"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ADDR_ROAD}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="410" y="278" width="109" height="17" uuid="23b9634c-07e7-4c85-b561-10b3b411cc6d"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DISTRICT_DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="569" y="278" width="131" height="17" uuid="8d27729b-8fb4-47bb-87d8-c94774150f29"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PROVINCE_DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="94" y="364" width="285" height="17" uuid="a718359d-e4d1-4919-872a-f79fd0f65b72"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GETNAME}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="217" y="387" width="77" height="17" uuid="e2858041-1d7a-40d1-bca5-c2d024321e12"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANCONTRACT_NO}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="329" y="387" width="106" height="17" uuid="54aeaaad-027e-4c93-bd39-167e61e1c090"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($F{LOANREQUEST_DATE})]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="283" y="410" width="129" height="17" uuid="b399b44f-98f7-4324-9618-6ab12dc93696"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANREQUEST_AMT}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="454" y="410" width="243" height="17" uuid="dc1020b1-7034-48ac-a339-a3b9a3b76a47"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FTREADTBAHT(LNREQLOAN.LOANREQUEST_AMT)}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="522" y="387" width="179" height="17" uuid="ecf92e55-3350-4d60-8f0b-36324accca76"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANOBJECTIVE_DESC}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="492" y="750" width="141" height="17" uuid="7d904a07-7729-452a-a3bd-3571a58acd56"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCRIPTION}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="235" y="255" width="150" height="17" uuid="bfcb4628-3985-469c-a6fb-69a164e3b608"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GROUP_AM}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="324" y="300" width="180" height="17" uuid="f15cff28-ac58-4652-8d18-6ff2d74fa666"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ADDR_MOBILEPHONE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="519" y="159" width="182" height="17" uuid="341c9994-9f20-467d-a5ad-1e2b541af33a"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{APDATE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="71" y="1" width="642" height="16" uuid="e3a4f141-0e6d-4d68-b015-4526bae0d7ce"/>
				<textElement textAlignment="Left">
					<font fontName="Angsana New" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA["ตั้งค่าหน้ากระดาษ กว้าง 28.14 cm x สูง 27.92 cm สั่งพิมพ์ Page Sizing เป็น Actual size / Orientation เป็น Portait"]]></textFieldExpression>
			</textField>
		</band>
		<band height="798">
			<textField>
				<reportElement x="274" y="274" width="146" height="17" uuid="42e06d2f-c4a1-4dd8-9285-5ba0e465c053"/>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCRIPTION}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="275" y="743" width="145" height="17" uuid="2af494ff-a3e4-42da-9084-98bd42068b99"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCRIPTION}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="0" width="798" height="17" forecolor="#FFFFFF" uuid="ded33000-6277-491b-a0e1-8967ab169f99"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCRIPTION}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
