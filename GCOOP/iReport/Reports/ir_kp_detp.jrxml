<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ir_kp_detp" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="04f5b17a-4a5f-4a59-bd11-5618e75d7fcc">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="as_coopid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_smembgroup" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_emembgroup" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_recvperiod" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
det.member_no as memebr_no ,
FT_GETMBNAME(det.coop_id,det.member_no) as full_name,
mb.membgroup_code as membgroup_code,
FT_MEMGRP(det.coop_id,mb.membgroup_code) as group_desc,
det.loancontract_no as loancontract_no,
det.description as description,
det.item_payment,
cm.coop_name,
case trim(SUBSTR(det.recv_period,5,6)) when '01' then 'มกราคม' when '02' then 'กุมภาพันธ์' when '03' then 'มีนาคม' when '04' then 'เมษายน' when '05' then 'พฤษภาคม' when '06' then 'มิถุนายน' when '07' then 'กรกฎาคม' when '08' then 'สิงหาคม' when '09' then 'กันยายน' when '10' then 'ตุลาคม' when '11' then 'พฤศจิกายน' when '12' then 'ธันวาคม'  else '' end  As month,
trim(SUBSTR(det.recv_period,1,4)) as year
from kptempreceivedet det
left join mbmembmaster mb on mb.member_no = det.member_no
left join cmcoopconstant cm on cm.coop_no = det.coop_id
where det.coop_id = $P{as_coopid}
and det.recv_period = $P{as_recvperiod}
and mb.membgroup_code between $P{as_smembgroup} and $P{as_emembgroup}
and det.keepitemtype_code like 'D0%'
and det.loancontract_no is not null
order by det.member_no]]>
	</queryString>
	<field name="MEMEBR_NO" class="java.lang.String"/>
	<field name="FULL_NAME" class="java.lang.String"/>
	<field name="MEMBGROUP_CODE" class="java.lang.String"/>
	<field name="GROUP_DESC" class="java.lang.String"/>
	<field name="LOANCONTRACT_NO" class="java.lang.String"/>
	<field name="DESCRIPTION" class="java.lang.String"/>
	<field name="ITEM_PAYMENT" class="java.math.BigDecimal"/>
	<field name="COOP_NAME" class="java.lang.String"/>
	<field name="MONTH" class="java.lang.String"/>
	<field name="YEAR" class="java.lang.String"/>
	<variable name="MEMEBR_NO_1" class="java.lang.Integer" calculation="DistinctCount">
		<variableExpression><![CDATA[$F{MEMEBR_NO}]]></variableExpression>
	</variable>
	<variable name="ITEM_PAYMENT_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ITEM_PAYMENT}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="60" splitType="Stretch">
			<textField>
				<reportElement uuid="67ff041d-6e92-499c-8cad-6fbdd304e519" x="0" y="0" width="555" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COOP_NAME}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="e0d5c8cb-a1e5-4fad-887a-05a7ca41ad33" x="441" y="0" width="114" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Angsana New"/>
				</textElement>
				<textFieldExpression><![CDATA["วันที่พิมพ์: "+new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format(new java.util.Date())]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="cca03eb7-35c8-44b3-9c86-d6f933682bdc" x="441" y="20" width="98" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Angsana New"/>
				</textElement>
				<textFieldExpression><![CDATA["หน้า "+$V{PAGE_NUMBER}+" /"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="ac34fbe3-c54e-4c05-a543-4dc72db8156c" x="539" y="20" width="16" height="20"/>
				<textElement>
					<font fontName="Angsana New"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="9ea2e8dd-3c11-4d03-8db5-0d4068ea427f" x="0" y="20" width="555" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["รายงานหักเงินต้นไปเงินฝาก"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="9f7bc91a-c297-4d37-9c8e-dd7bc8e64c9f" x="0" y="40" width="555" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["ประจำเดือน "+$F{MONTH}+" พ.ศ."+$F{YEAR}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="23" splitType="Stretch">
			<staticText>
				<reportElement uuid="0b33f863-d8f0-4d90-873a-4ef66d373437" x="28" y="2" width="50" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[เลขสมาชิก]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="712ad7c0-2eb1-4fb7-a175-76be8a393cb4" x="78" y="2" width="148" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[ชื่อ-สกุล]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="c73f962d-d6b4-42ff-be34-d82a8cad9dd5" x="226" y="2" width="150" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[หน่วย]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="b887f542-f2bb-4ac4-b1f0-f60d9c743818" x="376" y="2" width="65" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[เลขที่สัญญา]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="5427ce06-6956-4de7-99c5-e8b871d63557" x="441" y="2" width="59" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[เลขบัญชีที่โอน]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0c551c02-a9c7-4ae6-b616-111310912756" x="500" y="2" width="55" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[ยอดเงิน]]></text>
			</staticText>
			<line>
				<reportElement uuid="7226fb69-0309-4dc8-af42-dd646a21a000" x="0" y="1" width="555" height="1"/>
			</line>
			<line>
				<reportElement uuid="a957f221-c3fa-49ee-8742-d43a4190b030" x="0" y="22" width="555" height="1"/>
			</line>
			<staticText>
				<reportElement uuid="c9a23b78-c4ae-4198-afa2-39469e196dba" x="0" y="2" width="28" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[ลำดับ]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="991dcd77-18c2-4dbc-bf18-c555e92f8dc1" x="28" y="0" width="50" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{MEMEBR_NO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3c2b7b2a-cec0-4dd2-a33e-db3ffcaefbb4" x="78" y="0" width="148" height="20"/>
				<box leftPadding="3"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FULL_NAME}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="89c1995d-a4a4-40ec-9cc0-ce0412d0d03d" x="226" y="0" width="150" height="20"/>
				<box leftPadding="3"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GROUP_DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="a0038a7c-0bb0-40a0-8da8-9636440d6a76" x="441" y="0" width="59" height="20"/>
				<box leftPadding="3"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESCRIPTION}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="7c693669-0359-4310-b520-514e4d410a02" x="500" y="0" width="55" height="20"/>
				<box rightPadding="3"/>
				<textElement textAlignment="Right">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ITEM_PAYMENT}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="fc89b2f3-00c1-4923-b961-b8cea8d9a5cc" x="376" y="0" width="65" height="20"/>
				<box leftPadding="3"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANCONTRACT_NO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="5774a742-248b-4ad7-81f6-a3adb310077e" x="0" y="0" width="28" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="24" splitType="Stretch">
			<line>
				<reportElement uuid="929e271b-059c-4bc2-a2a0-6327b5dedbaa" x="0" y="0" width="555" height="1"/>
			</line>
			<line>
				<reportElement uuid="b95fad4d-c857-49b0-854a-ec13be009f0f" x="0" y="21" width="555" height="1"/>
			</line>
			<line>
				<reportElement uuid="87c2710e-446b-4527-9ed6-7290e259c9f5" x="0" y="23" width="555" height="1"/>
			</line>
			<textField>
				<reportElement uuid="40941c02-5c5f-4002-83e3-c3046b511a3a" x="78" y="1" width="84" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.text.DecimalFormat("#,##0").format($V{MEMEBR_NO_1})+" ราย"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="42d825a0-5e2e-4026-a565-38777830b5b2" x="441" y="1" width="116" height="20"/>
				<box rightPadding="3"/>
				<textElement textAlignment="Right">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{ITEM_PAYMENT_1}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="e48587c8-9a54-44a6-8db3-b2e431ed6eb9" x="0" y="1" width="78" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[รวมทั้งหมด]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
